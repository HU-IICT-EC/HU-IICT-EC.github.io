<section>
  <h3>Examinator Excel Download</h3>
  <ol>
    <li>
      <label>Log in op Osiris en download het HTML rapport 9.1.06</label>
      <button class="btn btn-primary mt-2" type="button"
        onclick="window.open('https://osiris.hu.nl/osiris_rapport/rapporten/faces/UIReportShell', '_blank')">
        Open Osiris
      </button>
      <ol type="a" class="mt-2">
        <li>Selecteer: Docent-&gt;Rol: EXAMINATOR</li>
        <li>Selecteer: Bestandsformaat: HTML</li>
        <li>
          Pas optionele selectie toe:
          <ul>
            <li>Collegejaar: Huidige periode</li>
            <li>Beperk cursussen tot: Alleen eigen cursussen</li>
            <li>etc</li>
          </ul>
        </li>
      </ol>
    </li>
    <li>
      <label for="examinatorFile">Upload het gedownloade HTML-bestand:</label>
      <input type="file" id="examinatorFile" class="form-control mt-2" accept=".html,.htm"
        aria-describedby="examinator-help" />
      <div id="examinator-help" class="form-text">
        Selecteer het HTML-bestand dat je van Osiris hebt gedownload.
      </div>
    </li>
    <li>
      <label>Na uploaden wordt het bestand automatisch verwerkt en kun je het resultaat downloaden.</label>
      <div class="mt-2">
        <span id="processing-indicator-examinator" style="display:none;" aria-live="polite">
          <span class="spinner-border spinner-border-sm text-primary" role="status" aria-hidden="true"></span>
          Bezig met verwerken...
        </span>
        <button id="download-examinator" class="btn btn-primary mt-2 disabled" type="button" tabindex="-1"
          aria-disabled="true">
          Download
        </button>
      </div>
    </li>
  </ol>
</section>

<py-script src="/assets/tools/examinator_excel_download.py" type="py"></py-script>

<script>
  document.getElementById('examinatorFile').addEventListener('change', function () {
    const indicator = document.getElementById('processing-indicator-examinator');
    indicator.style.display = 'inline-block';

    setTimeout(function () {
      document.getElementById('examinatorFile').dispatchEvent(new Event('process-excel'));
    }, 50);
  });
</script>