<section>
    <h3>Steekproef</h3>
    <ol>
        <li>
            <label for="steekproefFile">Upload het voorbereidde excelbestand:</label>
            <input type="file" id="steekproefFile" class="form-control mt-2" accept=".xlsx,.xls"
                aria-describedby="steekproef-help" />
            <div id="steekproef-help" class="form-text">
                Selecteer een Excel-bestand (.xlsx of .xls) om te verwerken.
            </div>
        </li>
        <li>
            <label>Na uploaden wordt het bestand automatisch verwerkt en kun je het resultaat downloaden.</label>
            <div class="mt-2">
                <span id="processing-indicator-steekproef" style="display:none;" aria-live="polite">
                    <span class="spinner-border spinner-border-sm text-primary" role="status" aria-hidden="true"></span>
                    Bezig met verwerken...
                </span>
                <button id="download-steekproef" class="btn btn-primary mt-2 disabled" type="button" tabindex="-1"
                    aria-disabled="true">
                    Download
                </button>
            </div>
        </li>
    </ol>
</section>

<py-script src="/assets/tools/steekproef.py" type="py"></py-script>

<script>
    document.getElementById('steekproefFile').addEventListener('change', function () {
        const indicator = document.getElementById('processing-indicator-steekproef');
        indicator.style.display = 'inline-block';

        setTimeout(function () {
            document.getElementById('steekproefFile').dispatchEvent(new Event('process-excel'));
        }, 50);
    });
</script>